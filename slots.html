<!DOCTYPE html>
<html>
<head>
<title>Ivory Ledger â€” Aristocrat Slots</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="center execTable">

<h1>Aristocrat Collection</h1>

<div class="paybox gold">
Player: <span id="player"></span><br>
Balance: $<span id="bal"></span><br><br>
ðŸ’Ž ULTRA JACKPOT ðŸ’Ž<br>
$<span id="jackpot"></span>
</div>

<div class="paybox">
Bet:
<button onclick="changeBet(-0.10)">âˆ’</button>
$<span id="betDisplay">0.10</span>
<button onclick="changeBet(0.10)">+</button>
<br><br>
<button onclick="spin()">SPIN</button>
</div>

<div id="reels"></div>
<div id="result"></div>

<button class="ghostBtn" onclick="location.href='members.html'">Return</button>

<script>
/* ---------------- CONFIG ---------------- */

let bet = 0.10;
const MINBET = 0.10;
const MAXBET = 25.00;

// Aristocrat inspired symbols
let symbols = ["ðŸ‰","ðŸ¼","ðŸ€„","ðŸ’°","ðŸ®","ðŸ¥‡","88"];

// ultra rare jackpot odds
const JACKPOT_ODDS = 10000;

// weekly jackpot range
const JACKPOT_MIN = 10500.00;
const JACKPOT_MAX = 122984.21;

// initial jackpot
let jackpot = parseFloat(localStorage.getItem("jackpot")) || 51655.71;

/* ---------------- PLAYER ---------------- */

player.innerHTML = localStorage.getItem("memberName") || "Guest";

function refreshBalance(){
 bal.innerHTML = parseFloat(localStorage.getItem("balance")||0).toFixed(2);
}
refreshBalance();

/* ---------------- WEEKLY JACKPOT RESET ---------------- */

function getWeekKey(){
 let d = new Date();
 let day = d.getDay(); // 0 sunday
 let diff = d.getDate() - day + (day===0?-6:1); // monday
 let monday = new Date(d.setDate(diff));
 return monday.toDateString();
}

let currentWeek = localStorage.getItem("jackpotWeek");
let thisWeek = getWeekKey();

if(currentWeek !== thisWeek){
 let newJackpot = (Math.random()*(JACKPOT_MAX-JACKPOT_MIN)+JACKPOT_MIN);
 jackpot = newJackpot;
 localStorage.setItem("jackpotWeek", thisWeek);
 localStorage.setItem("jackpot", jackpot.toFixed(2));
}

jackpotEl = document.getElementById("jackpot");
jackpotEl.innerHTML = jackpot.toFixed(2);

/* ---------------- UTILS ---------------- */

function logTx(type, amount, note){
 let tx=JSON.parse(localStorage.getItem("tx")||"[]");
 tx.unshift({
   time:new Date().toLocaleString(),
   type:type,
   amount:amount,
   note:note||""
 });
 tx=tx.slice(0,100);
 localStorage.setItem("tx",JSON.stringify(tx));
}

function addGame(w,wins){
 let wg=parseFloat(localStorage.getItem("wagered")||0);
 let wo=parseFloat(localStorage.getItem("won")||0);
 let g=parseInt(localStorage.getItem("games")||0);
 wg+=w; if(wins>0) wo+=wins; g++;
 localStorage.setItem("wagered",wg.toFixed(2));
 localStorage.setItem("won",wo.toFixed(2));
 localStorage.setItem("games",g);
}

/* ---------------- BET CONTROL ---------------- */

function changeBet(v){
 bet += v;
 if(bet < MINBET) bet = MINBET;
 if(bet > MAXBET) bet = MAXBET;
 bet = Math.round(bet*100)/100;
 betDisplay.innerHTML = bet.toFixed(2);
}

/* ---------------- SPIN ---------------- */

function spin(){
 let bal = parseFloat(localStorage.getItem("balance")||0);
 if(bal < bet){ alert("Insufficient balance"); return; }

 bal -= bet;

 // grow jackpot slightly each spin
 jackpot += bet*0.08;

 reels.innerHTML="";
 let row=[];

 for(let i=0;i<5;i++){
   let s = symbols[Math.floor(Math.random()*symbols.length)];
   row.push(s);
   let d=document.createElement("div");
   d.className="slot";
   d.innerHTML=s;
   reels.appendChild(d);
 }

 let payout = 0;

 // normal win (3+ match)
 if(row[0]===row[1] && row[1]===row[2]){
   payout = bet * 4;
 }

 // rare 5 match
 if(row.every(r=>r===row[0])){
   payout = bet * 25;
 }

 // ULTRA JACKPOT (1 in 10,000)
 if(Math.floor(Math.random()*JACKPOT_ODDS)===1){
   payout += jackpot;
   result.innerHTML = "ðŸ’Ž JACKPOT WON $"+jackpot.toFixed(2);
   logTx("Jackpot", jackpot, "Ultra Rare Jackpot");
   jackpot = (Math.random()*(JACKPOT_MAX-JACKPOT_MIN)+JACKPOT_MIN);
 }else if(payout>0){
   result.innerHTML = "WIN +$"+payout.toFixed(2);
 }else{
   result.innerHTML = "No win";
 }

 if(payout>0){
   bal += payout;
   logTx("Slots Win", payout, "Aristocrat slots");
 }else{
   logTx("Slots Spin", -bet, "Spin");
 }

 localStorage.setItem("balance",bal.toFixed(2));
 localStorage.setItem("jackpot",jackpot.toFixed(2));

 addGame(bet,payout);
 refreshBalance();
 jackpotEl.innerHTML = jackpot.toFixed(2);
}

/* ---------------- INIT ---------------- */

betDisplay.innerHTML = bet.toFixed(2);

</script>

<style>
.execTable{background:radial-gradient(circle,#2a0000,#000)}
#reels{display:flex;justify-content:center;gap:10px;margin:20px}
.slot{
 width:55px;height:75px;
 background:#111;
 border-radius:12px;
 font-size:34px;
 display:flex;
 align-items:center;
 justify-content:center;
 box-shadow:0 0 10px rgba(255,215,0,.25)
}
.gold{
 border:1px solid gold;
 box-shadow:0 0 25px rgba(255,215,0,.4)
}
</style>

</div>
</body>
</html>
